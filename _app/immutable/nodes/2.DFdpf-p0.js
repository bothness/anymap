import{a as T,t as C}from"../chunks/disclose-version.CBFeP9qm.js";import{i as ce}from"../chunks/legacy.CeR6iruq.js";import{I as X,k as he,x as ue,y as ye,z as y,A as ve,B as d,C as u,D as _,J as we,ah as N,ai as ze,q as i,K as h,L as Se,M as V,a9 as te,aB as ae}from"../chunks/runtime.DTQ_9slk.js";import{l as xe,s as Q,e as re}from"../chunks/render.D9G3lN37.js";import{i as pe}from"../chunks/if.BUlbJtog.js";import{s as W,a as je,I as Te,S as Ce,e as le,C as qe,p as ke,i as se,m as U,d as G}from"../chunks/Credit.DsLIRG_w.js";import{i as De,p as b,s as Oe,a as ie}from"../chunks/props.BkfbzHDM.js";import{b as Ae}from"../chunks/control.UqgIgW4B.js";import{g as Ee}from"../chunks/entry.BSAY12sL.js";import{c as Ie}from"../chunks/index-client.Zs5LPVau.js";function Le(e,t,s){X(()=>{var l=he(()=>t(e,s==null?void 0:s())||{});if(l!=null&&l.destroy)return()=>l.destroy()})}function de(e,t,s){if(e.multiple)return Pe(e,t);for(var l of e.options){var n=E(l);if(De(n,t)){l.selected=!0;return}}(!s||t!==void 0)&&(e.selectedIndex=-1)}function Me(e,t){X(()=>{var s=new MutationObserver(()=>{var l=e.__value;de(e,l)});return s.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{s.disconnect()}})}function ne(e,t,s=t){var l=!0;xe(e,"change",n=>{var v=n?"[selected]":":checked",p;if(e.multiple)p=[].map.call(e.querySelectorAll(v),E);else{var o=e.querySelector(v)??e.querySelector("option:not([disabled])");p=o&&E(o)}s(p)}),X(()=>{var n=t();if(de(e,n,l),l&&n===void 0){var v=e.querySelector(":checked");v!==null&&(n=E(v),s(n))}e.__value=n,l=!1}),Me(e)}function Pe(e,t){for(var s of e.options)s.selected=~t.indexOf(E(s))}function E(e){return"__value"in e?e.__value:e.value}function Ke(e){return function(...t){var s=t[0];return s.preventDefault(),e==null?void 0:e.apply(this,t)}}function Fe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var H,oe;function Ve(){if(oe)return H;oe=1;function e(t,s){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let l,n=0;return function(...p){clearTimeout(l);const o=Date.now(),q=o-n,f=s-q;f<=0?(n=o,t.apply(this,p)):l=setTimeout(()=>{n=Date.now(),t.apply(this,p)},f)}}return H=e,H}var Be=Ve();const Re=Fe(Be);var $e=C("<label> </label>"),Je=C('<!> <div class="autocomplete-container svelte-w4406e"></div>',1);function Ne(e,t){ue(t,!1);let s=b(t,"value",12,""),l=b(t,"options",24,()=>[]),n=b(t,"id",8,"autocomplete"),v=b(t,"label",8,"Select a place"),p=b(t,"hideLabel",8,!1),o=b(t,"mode",8,"search"),q=b(t,"placeholder",24,()=>o()==="search"?"Type any place name":"Select one"),f=b(t,"labelKey",8,"name"),I=b(t,"groupKey",8,"group"),B=b(t,"suggest",8,(r,g)=>{const z=l().filter(A=>A[f()].match(new RegExp(`\\b${r.replace(/[^\w\s]/gi,"")}`,"i")));g(z)});const k=Ie();function D(r){return(r==null?void 0:r[f()])||r||""}function L(r){return r!=null&&r[f()]?I()?`${r[f()]} <span class="muted-text">${r[I()]}</span>`:r[f()]:r}function x(r){r&&(s(r),k("change",r))}function O(r){window.accessibleAutocomplete({element:r,id:n(),defaultValue:s(),displayMenu:"overlay",source:B(),autoselect:o()==="search",onConfirm:x,placeholder:q(),showAllValues:o()==="default",minLength:o()==="search"?3:0,templates:{inputValue:D,suggestion:L}})}ce();var M=Je(),w=ye(M);{var P=r=>{var g=$e(),z=d(g,!0);u(g),y(()=>{W(g,"for",n()),je(g,"display",p()?"none":null),Q(z,v())}),T(r,g)};pe(w,r=>{v()&&r(P)})}var K=_(w,2);Le(K,r=>O==null?void 0:O(r)),y(()=>W(K,"id",`${n()??""}-container`)),T(e,M),ve()}var Ue=C("<option> </option>"),Ge=C("<option> </option>"),He=C('<span class="credit">First select a place to start the puzzle</span>'),Qe=C('<main><div class="title-block"><h1 class="title">Any Map Puzzle</h1> <div class="floating-icons"><button class="icon-button svelte-12pjwz2"><!>Share</button> <!></div></div> <form><!> <div class="columns svelte-12pjwz2"><div><label>Select map tiles<br> <select class="svelte-12pjwz2"></select></label> <label>Select difficulty<br> <select class="svelte-12pjwz2"></select></label> <p><button type="submit" class="button svelte-12pjwz2">Start puzzle</button> <!></p></div> <div class="tile svelte-12pjwz2"><img class="tile-img svelte-12pjwz2" alt=""></div></div></form> <!></main>');function it(e,t){ue(t,!1);const s=Oe(),l=()=>ie(q,"$config",s),n=()=>ie(ke,"$page",s),v=V(),p=V(),o=V(),q=we("config");let f=V(!1);async function I(a,c){if(a&&a.length<3)return c([]);const m=`https://nominatim.openstreetmap.org/search?q=${a}&format=geojson`,be=(await(await fetch(m)).json()).features.map(S=>({code:S.properties.osm_type[0].toUpperCase()+S.properties.osm_id,name:S.properties.name,group:S.properties.display_name.slice(S.properties.name.length+2).replaceAll("Israel","Palestine"),bbox:S.bbox,centroid:S.geometry.coordinates}));c(be)}function B(a){h(v,a.detail.code)}N(()=>l(),()=>{var a,c;h(v,(c=(a=l())==null?void 0:a.place)==null?void 0:c.code)}),N(()=>l(),()=>{h(p,G.find(a=>a.gridSize===l().gridSize)||G[1])}),N(()=>l(),()=>{h(o,U.find(a=>a.id===l().mapTiles)||U[0])}),ze(),ce();var k=Qe(),D=d(k),L=_(d(D),2),x=d(L),O=d(x);Te(O,{type:"share",margin:!0}),Se(),u(x);var M=_(x,2);Ce(M,{message:"Play map puzzles of any place %23AnyMapPuzzle",get url(){return n().url.href},get open(){return i(f)},set open(a){h(f,a)},$$legacy:!0}),u(L),u(D);var w=_(D,2),P=d(w),K=te(()=>{var a;return((a=l().place)==null?void 0:a.name)||""}),r=te(()=>Re(I,1e3));Ne(P,{get value(){return i(K)},get suggest(){return i(r)},$$events:{change:B}});var g=_(P,2),z=d(g),A=d(z),R=_(d(A),3);y(()=>{i(o),ae(()=>{})}),le(R,5,()=>U,se,(a,c)=>{var m=Ue(),j={},F=d(m,!0);u(m),y(()=>{j!==(j=i(c))&&(m.value=(m.__value=i(c))==null?"":i(c)),Q(F,i(c).label)}),T(a,m)}),u(R),u(A);var $=_(A,2),J=_(d($),3);y(()=>{i(p),ae(()=>{})}),le(J,5,()=>G,se,(a,c)=>{var m=Ge(),j={},F=d(m,!0);u(m),y(()=>{j!==(j=i(c))&&(m.value=(m.__value=i(c))==null?"":i(c)),Q(F,i(c).label)}),T(a,m)}),u(J),u($);var Y=_($,2),Z=d(Y),fe=_(Z,2);{var me=a=>{var c=He();T(a,c)};pe(fe,a=>{i(v)||a(me)})}u(Y),u(z);var ee=_(z,2),_e=d(ee);y(()=>W(_e,"src",i(o).url(19302,24631,16))),u(ee),u(g),u(w);var ge=_(w,2);qe(ge,{get attribution(){return i(o).attribution}}),u(k),y(()=>Z.disabled=!i(v)),re("click",x,()=>h(f,!i(f))),ne(R,()=>i(o),a=>h(o,a)),ne(J,()=>i(p),a=>h(p,a)),re("submit",w,Ke(()=>Ee(`${Ae}/${i(v)}?maptiles=${i(o).id}&gridsize=${i(p).gridSize}`))),T(e,k),ve()}export{it as component};
