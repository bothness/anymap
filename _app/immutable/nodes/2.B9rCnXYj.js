import{a as k,t as T}from"../chunks/disclose-version.DjvNnsPL.js";import"../chunks/legacy.CXxP-W4o.js";import{m as W,b as _e,p as ue,aw as ye,i as ze,t as y,j as ce,k as p,l as c,s as m,v as F,g as s,n as E,q as we,ab as ae,ax as re}from"../chunks/index-client.BvduMyYk.js";import{l as Se,s as J,e as le}from"../chunks/render.B8ji4My8.js";import{c as je,p as h,i as pe,s as xe,a as ke}from"../chunks/props.BVkKjN1A.js";import{a as Q,s as Te,d as G,m as U,I as Ae,S as qe,e as se,h as Oe,i as ie,p as Pe}from"../chunks/ShareButtons.CfQFikOp.js";import{i as ve}from"../chunks/lifecycle.gEcLSU_P.js";import{g as Ce,b as Ee}from"../chunks/entry.VpTtyMgw.js";function Me(e,t,l){W(()=>{var n=_e(()=>t(e,l==null?void 0:l())||{});if(n!=null&&n.destroy)return()=>n.destroy()})}function de(e,t,l){if(e.multiple)return Ve(e,t);for(var n of e.options){var i=M(n);if(je(i,t)){n.selected=!0;return}}(!l||t!==void 0)&&(e.selectedIndex=-1)}function De(e,t){W(()=>{var l=new MutationObserver(()=>{var n=e.__value;de(e,n)});return l.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{l.disconnect()}})}function ne(e,t,l=t){var n=!0;Se(e,"change",i=>{var v=i?"[selected]":":checked",d;if(e.multiple)d=[].map.call(e.querySelectorAll(v),M);else{var o=e.querySelector(v)??e.querySelector("option:not([disabled])");d=o&&M(o)}l(d)}),W(()=>{var i=t();if(de(e,i,n),n&&i===void 0){var v=e.querySelector(":checked");v!==null&&(i=M(v),l(i))}e.__value=i,n=!1}),De(e)}function Ve(e,t){for(var l of e.options)l.selected=~t.indexOf(M(l))}function M(e){return"__value"in e?e.__value:e.value}function Ie(e){return function(...t){var l=t[0];return l.preventDefault(),e==null?void 0:e.apply(this,t)}}function Le(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var H,oe;function Fe(){if(oe)return H;oe=1;function e(t,l){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let n,i=0;return function(...d){clearTimeout(n);const o=Date.now(),_=o-i,g=l-_;g<=0?(i=o,t.apply(this,d)):n=setTimeout(()=>{i=Date.now(),t.apply(this,d)},g)}}return H=e,H}var Ke=Fe();const Be=Le(Ke);var Ne=T("<label> </label>"),Re=T('<!> <div class="autocomplete-container svelte-w4406e"></div>',1);function Ge(e,t){ue(t,!1);let l=h(t,"value",12,""),n=h(t,"options",24,()=>[]),i=h(t,"id",8,"autocomplete"),v=h(t,"label",8,"Select a place"),d=h(t,"hideLabel",8,!1),o=h(t,"mode",8,"search"),_=h(t,"placeholder",24,()=>o()==="search"?"Type any place name":"Select one"),g=h(t,"labelKey",8,"name"),D=h(t,"groupKey",8,"group"),A=h(t,"suggest",8,(a,b)=>{const w=n().filter(C=>C[g()].match(new RegExp(`\\b${a.replace(/[^\w\s]/gi,"")}`,"i")));b(w)});const q=ye();function V(a){return(a==null?void 0:a[g()])||a||""}function j(a){return a!=null&&a[g()]?D()?`${a[g()]} <span class="muted-text">${a[D()]}</span>`:a[g()]:a}function K(a){a&&(l(a),q("change",a))}function O(a){window.accessibleAutocomplete({element:a,id:i(),defaultValue:l(),displayMenu:"overlay",source:A(),autoselect:o()==="search",onConfirm:K,placeholder:_(),showAllValues:o()==="default",minLength:o()==="search"?3:0,templates:{inputValue:V,suggestion:j}})}ve();var z=Re(),P=ze(z);{var B=a=>{var b=Ne(),w=p(b,!0);c(b),y(()=>{Q(b,"for",i()),Te(b,"display",d()?"none":null),J(w,v())}),k(a,b)};pe(P,a=>{v()&&a(B)})}var I=m(P,2);Me(I,a=>O==null?void 0:O(a)),y(()=>Q(I,"id",`${i()??""}-container`)),k(e,z),ce()}var Ue=T("<option> </option>"),He=T("<option> </option>"),Je=T('<span class="credit">First select a place to start the puzzle</span>'),Qe=T(`<main><div class="title-block"><h1 class="title">Any Map Puzzle</h1> <div class="floating-icons"><button class="icon-button svelte-12pjwz2"><!>Share</button> <!></div></div> <form><!> <div class="columns svelte-12pjwz2"><div><label>Select map tiles<br> <select class="svelte-12pjwz2"></select></label> <label>Select difficulty<br> <select class="svelte-12pjwz2"></select></label> <p><button type="submit" class="button svelte-12pjwz2">Start puzzle</button> <!></p></div> <div class="tile svelte-12pjwz2"><img class="tile-img svelte-12pjwz2" alt=""></div></div></form> <p class="credit">Any Map Puzzle was designed and coded by <a target="_blank" href="https://bsky.app/profile/bothness.bsky.social">Ahmad Barclay</a>, inspired by Eugene Alvin Villar's <a target="_blank" href="https://seav.github.io/osm-15-puzzle/">OSM 15 Puzzle</a>. View the <a target="_blank" href="https://github.com/bothness/anymap/">source code</a> on Github. Area search powered by <a target="_blank" href="https://nominatim.org/">Nominatim</a>. <!></p></main>`);function rt(e,t){var ee,te;ue(t,!1);const l=xe(),n=()=>ke(Pe,"$page",l);let i=h(t,"data",8),v=F((te=(ee=i())==null?void 0:ee.place)==null?void 0:te.code),d=F(G.find(r=>r.gridSize===i().gridSize)||G[1]),o=F(U.find(r=>r.id===i().mapTiles)||U[0]),_=F(!1);async function g(r,u){if(r&&r.length<3)return u([]);const f=`https://nominatim.openstreetmap.org/search?q=${r}&format=geojson`,ge=(await(await fetch(f)).json()).features.map(S=>({code:S.properties.osm_type[0].toUpperCase()+S.properties.osm_id,name:S.properties.name,group:S.properties.display_name.slice(S.properties.name.length+2).replaceAll("Israel","Palestine"),bbox:S.bbox,centroid:S.geometry.coordinates}));u(ge)}function D(r){E(v,r.detail.code)}ve();var A=Qe(),q=p(A),V=m(p(q),2),j=p(V),K=p(j);Ae(K,{type:"share",margin:!0}),we(),c(j);var O=m(j,2);qe(O,{message:"Play map puzzles of any place %23AnyMapPuzzle",get url(){return n().url.href},get open(){return s(_)},set open(r){E(_,r)},$$legacy:!0}),c(V),c(q);var z=m(q,2),P=p(z),B=ae(()=>{var r,u;return((u=(r=i())==null?void 0:r.place)==null?void 0:u.name)||""}),I=ae(()=>Be(g,1e3));Ge(P,{get value(){return s(B)},get suggest(){return s(I)},$$events:{change:D}});var a=m(P,2),b=p(a),w=p(b),C=m(p(w),3);y(()=>{s(o),re(()=>{})}),se(C,5,()=>U,ie,(r,u)=>{var f=Ue(),x={},L=p(f,!0);c(f),y(()=>{x!==(x=s(u))&&(f.value=(f.__value=s(u))==null?"":s(u)),J(L,s(u).label)}),k(r,f)}),c(C),c(w);var N=m(w,2),R=m(p(N),3);y(()=>{s(d),re(()=>{})}),se(R,5,()=>G,ie,(r,u)=>{var f=He(),x={},L=p(f,!0);c(f),y(()=>{x!==(x=s(u))&&(f.value=(f.__value=s(u))==null?"":s(u)),J(L,s(u).label)}),k(r,f)}),c(R),c(N);var X=m(N,2),Y=p(X),fe=m(Y,2);{var me=r=>{var u=Je();k(r,u)};pe(fe,r=>{s(v)||r(me)})}c(X),c(b);var Z=m(b,2),be=p(Z);y(()=>Q(be,"src",s(o).url(19302,24631,16))),c(Z),c(a),c(z);var $=m(z,2),he=m(p($),9);Oe(he,()=>s(o).attribution),c($),c(A),y(()=>Y.disabled=!s(v)),le("click",j,()=>E(_,!s(_))),ne(C,()=>s(o),r=>E(o,r)),ne(R,()=>s(d),r=>E(d,r)),le("submit",z,Ie(()=>Ce(`${Ee}/${s(v)}?maptiles=${s(o).id}&gridsize=${s(d).gridSize}`))),k(e,A),ce()}export{rt as component};
