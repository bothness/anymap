import{a as T,t as C}from"../chunks/disclose-version.99O-hdS6.js";import{i as ce}from"../chunks/legacy.DWlfCNZp.js";import{I as W,k as ye,x as ve,y as Se,z as y,A as fe,B as c,C as o,D as m,J as we,O as V,q as i,M as E,N as xe,ab as ae,aB as re}from"../chunks/runtime.D7Av2bsv.js";import{l as ze,s as H,e as le}from"../chunks/render.DAZ0GJAO.js";import{i as pe}from"../chunks/if.Daf_QZpO.js";import{s as Q,a as Te,d as J,m as U,I as Ce,S as qe,e as se,C as Oe,p as De,i as ie}from"../chunks/Credit.BEsBnRHe.js";import{i as je,p as _,s as ke,a as ne}from"../chunks/props.rWO465ez.js";import{b as Ee}from"../chunks/control.DCNBUJSy.js";import{g as Me}from"../chunks/entry.BclCdMHo.js";import{c as Pe}from"../chunks/index-client.DKpeL2NU.js";function Ae(e,t,r){W(()=>{var s=ye(()=>t(e,r==null?void 0:r())||{});if(s!=null&&s.destroy)return()=>s.destroy()})}function de(e,t,r){if(e.multiple)return Le(e,t);for(var s of e.options){var n=M(s);if(je(n,t)){s.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Ie(e,t){W(()=>{var r=new MutationObserver(()=>{var s=e.__value;de(e,s)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function oe(e,t,r=t){var s=!0;ze(e,"change",n=>{var h=n?"[selected]":":checked",v;if(e.multiple)v=[].map.call(e.querySelectorAll(h),M);else{var u=e.querySelector(h)??e.querySelector("option:not([disabled])");v=u&&M(u)}r(v)}),W(()=>{var n=t();if(de(e,n,s),s&&n===void 0){var h=e.querySelector(":checked");h!==null&&(n=M(h),r(n))}e.__value=n,s=!1}),Ie(e)}function Le(e,t){for(var r of e.options)r.selected=~t.indexOf(M(r))}function M(e){return"__value"in e?e.__value:e.value}function Fe(e){return function(...t){var r=t[0];return r.preventDefault(),e==null?void 0:e.apply(this,t)}}function Ke(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var G,ue;function Ve(){if(ue)return G;ue=1;function e(t,r){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let s,n=0;return function(...v){clearTimeout(s);const u=Date.now(),b=u-n,f=r-b;f<=0?(n=u,t.apply(this,v)):s=setTimeout(()=>{n=Date.now(),t.apply(this,v)},f)}}return G=e,G}var Be=Ve();const Re=Ke(Be);var $e=C("<label> </label>"),Ne=C('<!> <div class="autocomplete-container svelte-w4406e"></div>',1);function Je(e,t){ve(t,!1);let r=_(t,"value",12,""),s=_(t,"options",24,()=>[]),n=_(t,"id",8,"autocomplete"),h=_(t,"label",8,"Select a place"),v=_(t,"hideLabel",8,!1),u=_(t,"mode",8,"search"),b=_(t,"placeholder",24,()=>u()==="search"?"Type any place name":"Select one"),f=_(t,"labelKey",8,"name"),P=_(t,"groupKey",8,"group"),B=_(t,"suggest",8,(a,g)=>{const w=s().filter(j=>j[f()].match(new RegExp(`\\b${a.replace(/[^\w\s]/gi,"")}`,"i")));g(w)});const q=Pe();function O(a){return(a==null?void 0:a[f()])||a||""}function A(a){return a!=null&&a[f()]?P()?`${a[f()]} <span class="muted-text">${a[P()]}</span>`:a[f()]:a}function x(a){a&&(r(a),q("change",a))}function D(a){window.accessibleAutocomplete({element:a,id:n(),defaultValue:r(),displayMenu:"overlay",source:B(),autoselect:u()==="search",onConfirm:x,placeholder:b(),showAllValues:u()==="default",minLength:u()==="search"?3:0,templates:{inputValue:O,suggestion:A}})}ce();var I=Ne(),S=Se(I);{var L=a=>{var g=$e(),w=c(g,!0);o(g),y(()=>{Q(g,"for",n()),Te(g,"display",v()?"none":null),H(w,h())}),T(a,g)};pe(S,a=>{h()&&a(L)})}var F=m(S,2);Ae(F,a=>D==null?void 0:D(a)),y(()=>Q(F,"id",`${n()??""}-container`)),T(e,I),fe()}var Ue=C("<option> </option>"),Ge=C("<option> </option>"),He=C('<span class="credit">First select a place to start the puzzle</span>'),Qe=C('<main><div class="flex-row"><h1 class="flex-left">Any Map Puzzle</h1> <div class="floating-icons flex-right"><button class="icon-button svelte-homp7b"><!>Share</button> <!></div></div> <form><!> <div class="columns svelte-homp7b"><div><label>Select map tiles<br> <select class="svelte-homp7b"></select></label> <label>Select difficulty<br> <select class="svelte-homp7b"></select></label> <p><button type="submit" class="button svelte-homp7b">Start puzzle</button> <!></p></div> <div class="tile svelte-homp7b"><img class="tile-img svelte-homp7b" alt=""></div></div></form> <!></main>');function it(e,t){var ee,te;ve(t,!1);const r=ke(),s=()=>ne(h,"$config",r),n=()=>ne(De,"$page",r),h=we("config");let v=V((te=(ee=s())==null?void 0:ee.place)==null?void 0:te.code),u=V(J.find(l=>l.gridSize===s().gridSize)||J[1]),b=V(U.find(l=>l.id===s().mapTiles)||U[0]),f=V(!1);async function P(l,p){const d=`https://nominatim.openstreetmap.org/search?q=${l}&format=jsonv2`,_e=(await(await fetch(d)).json()).map(k=>({code:k.osm_type[0].toUpperCase()+k.osm_id,name:k.name,group:k.display_name.slice(k.name.length+2).replace(/israel$/i,"Palestine")}));p(_e)}function B(l){E(v,l.detail.code)}ce();var q=Qe(),O=c(q),A=m(c(O),2),x=c(A),D=c(x);Ce(D,{type:"share",margin:!0}),xe(),o(x);var I=m(x,2);qe(I,{message:"Play map puzzles of any place %23AnyMapPuzzle",get url(){return n().url.href},get open(){return i(f)},set open(l){E(f,l)},$$legacy:!0}),o(A),o(O);var S=m(O,2),L=c(S),F=ae(()=>{var l;return((l=s().place)==null?void 0:l.name)||""}),a=ae(()=>Re(P,1e3));Je(L,{get value(){return i(F)},get suggest(){return i(a)},$$events:{change:B}});var g=m(L,2),w=c(g),j=c(w),R=m(c(j),3);y(()=>{i(b),re(()=>{})}),se(R,5,()=>U,ie,(l,p)=>{var d=Ue(),z={},K=c(d,!0);o(d),y(()=>{z!==(z=i(p))&&(d.value=(d.__value=i(p))==null?"":i(p)),H(K,i(p).label)}),T(l,d)}),o(R),o(j);var $=m(j,2),N=m(c($),3);y(()=>{i(u),re(()=>{})}),se(N,5,()=>J,ie,(l,p)=>{var d=Ge(),z={},K=c(d,!0);o(d),y(()=>{z!==(z=i(p))&&(d.value=(d.__value=i(p))==null?"":i(p)),H(K,i(p).label)}),T(l,d)}),o(N),o($);var X=m($,2),Y=c(X),me=m(Y,2);{var he=l=>{var p=He();T(l,p)};pe(me,l=>{i(v)||l(he)})}o(X),o(w);var Z=m(w,2),be=c(Z);y(()=>Q(be,"src",i(b).url(19302,24631,16))),o(Z),o(g),o(S);var ge=m(S,2);Oe(ge,{get attribution(){return i(b).attribution}}),o(q),y(()=>Y.disabled=!i(v)),le("click",x,()=>E(f,!i(f))),oe(R,()=>i(b),l=>E(b,l)),oe(N,()=>i(u),l=>E(u,l)),le("submit",S,Fe(()=>Me(`${Ee}/${i(v)}?maptiles=${i(b).id}&gridsize=${i(u).gridSize}`))),T(e,q),fe()}export{it as component};
